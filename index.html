<!DOCTYPE html>
<html>

<head>
    <title>Spatial Signatures in Great Britain</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- load leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>

    <!-- load VectorGrid extension -->
    <script src="https://unpkg.com/leaflet.vectorgrid@1.3.0/dist/Leaflet.VectorGrid.bundled.js"></script>

    <!-- legend styles -->
    <style type='text/css'>
        /* Import ET Book styles
        adapted from https://github.com/edwardtufte/et-book/blob/gh-pages/et-book.css */

        @font-face {
            font-family: "et-book";
            src: url("et-book/et-book-roman-line-figures/et-book-roman-line-figures.eot");
            src: url("et-book/et-book-roman-line-figures/et-book-roman-line-figures.eot?#iefix") format("embedded-opentype"), url("et-book/et-book-roman-line-figures/et-book-roman-line-figures.woff") format("woff"), url("et-book/et-book-roman-line-figures/et-book-roman-line-figures.ttf") format("truetype"), url("et-book/et-book-roman-line-figures/et-book-roman-line-figures.svg#etbookromanosf") format("svg");
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        @font-face {
            font-family: "et-book";
            src: url("et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.eot");
            src: url("et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.eot?#iefix") format("embedded-opentype"), url("et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.woff") format("woff"), url("et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.ttf") format("truetype"), url("et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.svg#etbookromanosf") format("svg");
            font-weight: normal;
            font-style: italic;
            font-display: swap;
        }

        @font-face {
            font-family: "et-book";
            src: url("et-book/et-book-bold-line-figures/et-book-bold-line-figures.eot");
            src: url("et-book/et-book-bold-line-figures/et-book-bold-line-figures.eot?#iefix") format("embedded-opentype"), url("et-book/et-book-bold-line-figures/et-book-bold-line-figures.woff") format("woff"), url("et-book/et-book-bold-line-figures/et-book-bold-line-figures.ttf") format("truetype"), url("et-book/et-book-bold-line-figures/et-book-bold-line-figures.svg#etbookromanosf") format("svg");
            font-weight: bold;
            font-style: normal;
            font-display: swap;
        }

        body {
            font-family: sans-serif;
        }

        .maplegend {
            position: absolute;
            z-index: 9999;
            background-color: rgba(255, 255, 255, .8);
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            padding: 10px;
            font-size: 12px/14px;
            right: 10px;
            bottom: 20px;
            display: none;
            font-family: 'et-book', serif;
        }

        .maplegend .legend-title {
            text-align: left;
            margin-bottom: 10px;
            font-weight: 600;
            color: #3B6E8D;
            font-size: larger;
        }

        .maplegend .legend-scale ul {
            margin: 0;
            margin-bottom: 0px;
            padding: 0;
            float: left;
            list-style: none;
        }

        .maplegend .legend-scale ul li {
            list-style: none;
            margin-left: 0;
            line-height: 16px;
            margin-bottom: 6px;
        }

        .maplegend ul.legend-labels li span {
            display: block;
            float: left;
            height: 14px;
            width: 14px;
            margin-right: 5px;
            margin-left: 0;
            border: 0px solid #ccc;
        }

        .maplegend .legend-source {
            color: #777;
            clear: both;
        }

        .maplegend a {
            color: #777;
        }

        #maptitle {
            position: absolute;
            z-index: 9999;
            background-color: rgba(255, 255, 255, .8);
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            padding: 20px;
            margin-left: 20px;
            font-size: 12px;
            right: 10px;
            top: 20px;
            max-width: 480px;
            height: 50%;
            display: none;
        }

        div.overflow {
            overflow-y: auto;
            height: 100%;
        }

        h1 {
            font-size: 30px;
            font-family: 'et-book', serif;
            color: #3B6E8D;
        }

        h2 {
            font-size: 25px;
            font-family: 'et-book', serif;
            color: #3B6E8D;
        }

        h3 {
            font-size: 20px;
            font-family: 'et-book', serif;
            color: #BD5B4F;
        }

        div.logos {
            height: 100px;
            margin-top: 30px;
            padding: 0 30px 0 30px;
        }

        div.logos img {
            vertical-align: middle;
        }

        div.logos a {
            height: 100%;
        }

        button.toggle-title {
            position: absolute;
            z-index: 99999;
            background-color: rgba(255, 255, 255, .8);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            border: 0;
            padding: 5px;
            font-size: 12px;
            right: 10px;
            top: 20px;
        }

        button.toggle-legend {
            position: absolute;
            z-index: 99999;
            background-color: rgba(255, 255, 255, .8);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            border: 0;
            padding: 5px;
            font-size: 12px;
            right: 10px;
            bottom: 20px;
        }

        @media only screen and (min-width: 1920px) {

            button.toggle-title,
            button.toggle-legend {
                padding: 10px;
                font-size: 18px;
            }
        }
    </style>

    <script>
        function toggleTitle() {
            var x = document.getElementById("maptitle");
            if (x.style.display === "block") {
                x.style.display = "none";
            } else {
                x.style.display = "block";
            }
        };

        function toggleLegend() {
            var x = document.getElementById("maplegend signaturetype");
            if (x.style.display === "block") {
                x.style.display = "none";
            } else {
                x.style.display = "block";
            }
        }
    </script>

</head>

<body style='margin:0'>
    <button onclick="toggleTitle()" class="toggle-title">Details</button>
    <div id="maptitle">
        <div class="overflow">
            <h1>Spatial Signatures in Great Britain
            </h1>
            Spatial signatures characterise space based on form and function in a way designed to understand urban
            environments. This map, part of the <a href="https://urbangrammarai.xyz">Urban Grammar project</a>,
            shows a typology of spatial signatures in
            Great Britain. Each type has a distinct character capturing what the place looks like (form) and how it
            is used (function). Below you can find the "pen portraits” for the typology, shorthand descriptions of
            the characteristics of each signature type.

            <div class="logos">
                <a href="https://www.liverpool.ac.uk/geographic-data-science/"><img
                        src="https://urbangrammarai.xyz/_static/gdsl.png" alt="GDSL" width="28%"
                        style="margin-right: 4%"></a>
                <a href="https://www.liverpool.ac.uk"><img src="https://urbangrammarai.xyz/_static/liv_logo.png"
                        alt="University of Liverpool" width="28%" style="margin-right: 4%"></a>
                <a href="https://www.turing.ac.uk/"><img src="https://urbangrammarai.xyz/_static/ati_logo.png" alt="ATI"
                        width="30%"></a>
            </div>

            The classification is released as an open data product available from the <a href="https://data.cdrc.ac.uk/dataset/spatial-signatures-great-britain">Consumer Data Research
                Centre</a>. <a href="https://data.cdrc.ac.uk/dataset/spatial-signatures-great-britain">Access the data download</a> (you will need to provide a free login).
            <br />
            For more background on the spatial signatures, you can check the <a
                href="https://urbangrammarai.xyz">project website</a>.
            <!-- or read the related  academic papers: -->

            <h2>Pen portraits</h2>
            Pen portraits are short descriptions of each signature type.
            <h3>Wild countryside</h3>
            In “Wild countryside”, human influence is the least intensive. This signature covers large open spaces in
            the countryside where no urbanisation happens apart from occasional roads, cottages, and pastures. You can
            find it across the Scottish Highlands, numerous national parks such as Lake District, or in the majority of
            Wales.
            <h3>Countryside agriculture </h3>
            “Countryside agriculture” features much of the English countryside and displays a high degree of agriculture
            including both fields and pastures. There are a few buildings scattered across the area but, for the most
            part, it is green space.
            <h3>Urban buffer </h3>
            “Urban buffer” can be characterised as a green belt around cities. This signature includes mostly
            agricultural land in the immediate adjacency of towns and cities, often including edge development. It still
            feels more like countryside than urban, but these signatures are much smaller compared to other countryside
            types.
            <h3>Open sprawl </h3>
            “Open sprawl” represents the transition between countryside and urbanised land. It is located in the
            outskirts of cities or around smaller towns and is typically made up of large open space areas intertwined
            with different kinds of
            human development, from highways to smaller neighbourhoods.
            <h3>Disconnected suburbia </h3>
            “Disconnected suburbia” includes residential developments in the outskirts of cities or even towns and
            villages with convoluted, disconnected street networks, low built-up and population densities, and lack of
            jobs and services. This signature type is entirely car-dependent.
            <h3>Accessible suburbia </h3>
            “Accessible suburbia” covers residential development on the urban periphery with a relatively legible and
            connected street network, albeit less so than other more urban signature types. Areas in this signature
            feature low density, both in terms of population and built-up area, lack of jobs and services. For these
            reasons, “accessible suburbia” largely acts as dormitories.
            <h3>Warehouse/Park land</h3>
            “Warehouse/Park land” covers predominantly industrial areas and other work-related developments made of
            box-like
            buildings with large footprints. It contains many jobs of manual nature such as manufacturing or
            construction, and very little population live here compared to the rest of urban areas.
            Occasionally this type also covers areas of parks with large scale green open areas.
            <h3>Gridded residential quarters </h3>
            “Gridded residential quarters” are areas with street networks forming a well-connected grid-like (high
            density of 4-way intersections) pattern, resulting in places with smaller blocks and higher granularity.
            This signature is mostly residential but includes some services and jobs, and it tends to be located away
            from city centres.
            <h3>Connected residential neighbourhoods </h3>
            “Connected residential neighbourhoods” are relatively dense urban areas, both in terms of population and
            built-up area, that tend to be formed around well-connected street networks. They have access to services
            and some jobs but may be further away from city centres leading to higher dependency on cars and public
            transport for their residents.
            <h3>Dense residential neighbourhoods </h3>
            A “dense residential neighbourhood” is an abundant signature often covering large parts of cities outside of
            their centres. It has primarily residential purpose and high population density, varied street network
            patterns, and some services and jobs but not in high intensity.
            <h3>Dense urban neighbourhoods </h3>
            “Dense urban neighbourhoods” are areas of inner-city with high population and built-up density of a
            predominantly residential nature but with direct access to jobs and services. This signature type tends to
            be relatively walkable and, in the case of some towns, may even form their centres.
            <h3>Local urbanity </h3>
            “Local urbanity” reflects town centres, outer parts of city centres or even district centres. In all cases,
            this signature is very much urban in essence, combining high population and built-up density, access to
            amenities and jobs. Yet, it is on the lower end of the hierarchy of signature types denoting urban centres
            with only a local significance.
            <h3>Regional urbanity </h3>
            “Regional urbanity” captures centres of mid-size cities with regional importance such as Liverpool, Plymouth
            or Newcastle upon Tyne. It is often encircled by “Local urbanity” signatures and can form outer rings of
            city centres in large cities. It features high population density, as well as a high number of jobs and
            amenities within walkable distance.
            <h3>Metropolitan urbanity </h3>
            Signature type “Metropolitan urbanity” captures the centre of the largest cities in Great Britain such as
            Glasgow, Birmingham or Manchester. It is characterised by a very high number of jobs in the area, high
            built-up density and often high population density. This type serves as the core centre of the entire
            metropolitan areas.
            <h3>Concentrated urbanity </h3>
            Concentrated urbanity” is a signature type found in the city centre of London and nowhere else in Great
            Britain. It reflects the uniqueness of London in the British context with an extremely high number of jobs
            and amenities located nearby, as well as high built-up and population densities. Buildings in this signature
            are large and tightly packed, forming complex shapes with courtyards and little green space.
            <h3>Hyper concentrated urbanity </h3>
            The epitome of urbanity in the British context. “Hyper concentrated urbanity" is a signature type present
            only
            in the centre of London, around the Soho district, and covering Oxford and Regent streets. This signature is
            the result of centuries of urban primacy, with a multitude of historical layers interwoven, very high
            built-up and population density, and extreme abundance of amenities, services and jobs.

            <br />
            <br />
            Have you found an issue with the map? Please report it to our <a
                href="https://github.com/urbangrammarai/great-britain/issues">GitHub tracker</a>.

        </div>
    </div>

    <!-- div containing map -->
    <div id="map" style="width: 100vw; height: 100vh; background: #fdfdfd"></div>

    <!-- specification of leaflet map -->
    <script>
        // defaults
        const minZoom = 6;
        const maxZoom = 15;

        // get parameters from URL to allow custom location and zoom start
        var params = {};
        window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {
            params[key] = value;
        });

        // create map
        var map = L.map('map', {
            center: [params.lat || 53.4107, params.lng || -2.9704],
            minZoom: minZoom,
            maxZoom: maxZoom,
            zoomControl: true,
            zoom: params.zoom || 12,
        });

        // add background basemap
        var mapBaseLayer = L.tileLayer(
            'https://api.mapbox.com/styles/v1/martinfleis/ckl6okytj5fg317mvpgc9tc6k/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoibWFydGluZmxlaXMiLCJhIjoiY2tydnN4ems4MDl3cDJvcnhjZmZyMng1OSJ9.keLNOQHto3pzzJB1py9BVg', {
            attribution: '&copy; <a href="https://mapbox.com">Mapbox</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }
        ).addTo(map);

        // get vector tiles URL
        var mapUrl = "tiles/{z}/{x}/{y}.pbf";

        // mapping fof colors to signature types
        const cmap = {
            "0_0": "#f2e6c7",
            "1_0": "#8fa37e",
            "3_0": "#d7a59f",
            "4_0": "#d7ded1",
            "5_0": "#c3abaf",
            "6_0": "#e4cbc8",
            "7_0": "#c2d0d9",
            "8_0": "#f0d17d",
            "2_0": "#678ea6",
            "2_1": "#94666e",
            "2_2": "#efc758",
            "9_0": "#3b6e8c",
            "9_1": "#333432",
            "9_2": "#ab888e",
            "9_3": "#c1c1c0",
            "9_4": "#bc5b4f",
            "9_5": "#a7b799",
            "9_6": "#c1c1c0",
            "9_7": "#c1c1c0",
            "9_8": "#c1c1c0"
        };

        // mapping of names to signature types to be shown in popup on click
        const popup_info = {
            "0_0": "<strong>Signature type</strong><br>Countryside agriculture",
            "1_0": "<strong>Signature type</strong><br>Accessible suburbia",
            "3_0": "<strong>Signature type</strong><br>Open sprawl",
            "4_0": "<strong>Signature type</strong><br>Wild countryside",
            "5_0": "<strong>Signature type</strong><br>Warehouse/Park land",
            "6_0": "<strong>Signature type</strong><br>Gridded residential quarters",
            "7_0": "<strong>Signature type</strong><br>Urban buffer",
            "8_0": "<strong>Signature type</strong><br>Disconnected suburbia",
            "2_0": "<strong>Signature type</strong><br>Dense residential neighbourhoods",
            "2_1": "<strong>Signature type</strong><br>Connected residential neighbourhoods",
            "2_2": "<strong>Signature type</strong><br>Dense urban neighbourhoods",
            "9_0": "<strong>Signature type</strong><br>Local urbanity",
            "9_1": "<strong>Signature type</strong><br>Concentrated urbanity",
            "9_2": "<strong>Signature type</strong><br>Regional urbanity",
            "9_4": "<strong>Signature type</strong><br>Metropolitan urbanity",
            "9_5": "<strong>Signature type</strong><br>Hyper concentrated urbanity",
        };

        // define styling of vector tiles
        var vectorTileStyling = {
            signatures_combined_levels_clipped_4326: function (properties, zoom) {
                var weight = 0;
                if (zoom > 12) {
                    weight = 1.0;
                }
                return ({
                    fill: true,
                    weight: weight,
                    color: "#ffffff",
                    fillColor: cmap[properties.signature_type],
                    fillOpacity: 0.9,
                    opacity: 1.0,
                });
            }
        }

        // define options of vector tiles
        var mapVectorTileOptions = {
            rendererFactory: L.canvas.tile,
            interactive: true,
            attribution: '&copy; <a href="https://martinfleischmann.net">Martin Fleischmann</a>, <a href="https://darribas.org">Dani Arribas-Bel</a>, <a href="https://urbangrammarai.xyz">Urban Grammar AI research project</a>',
            maxNativeZoom: maxZoom,
            minZoom: minZoom,
            vectorTileLayerStyles: vectorTileStyling,
        };

        // create VectorGrid layer and add popup to it
        var mapPbfLayer = new L.VectorGrid.Protobuf(
            mapUrl, mapVectorTileOptions
        ).on('click', function (e) {
            L.popup()
                .setContent(popup_info[e.layer.properties.signature_type])
                .setLatLng(e.latlng)
                .openOn(map);
        });

        // add VectorGrid layer to map
        mapPbfLayer.addTo(map);

        // add transparent  road basemap on top
        var roads = L.tileLayer(
            'https://api.mapbox.com/styles/v1/martinfleis/ckl6jkuwe3uxa17mrhnp78e62/tiles/256/{z}/{x}/{y}{r}?access_token=pk.eyJ1IjoibWFydGluZmxlaXMiLCJhIjoiY2tydnN4ems4MDl3cDJvcnhjZmZyMng1OSJ9.keLNOQHto3pzzJB1py9BVg', {
            attribution: '',
            opacity: 0.3
        }
        ).addTo(map);

        // add label basemap layer on top
        var labels = L.tileLayer(
            'https://api.mapbox.com/styles/v1/martinfleis/ckl6n87ha0tol17o61wxhfnbo/tiles/256/{z}/{x}/{y}{r}?access_token=pk.eyJ1IjoibWFydGluZmxlaXMiLCJhIjoiY2tydnN4ems4MDl3cDJvcnhjZmZyMng1OSJ9.keLNOQHto3pzzJB1py9BVg', {
            attribution: '',
        }
        ).addTo(map);

        // add scalebar
        L.control.scale().addTo(map);
    </script>

    <!-- legend -->
    <button onclick="toggleLegend()" class="toggle-legend">Legend</button>
    <div id='maplegend signaturetype' class='maplegend'>
        <div class='legend-title'>Spatial signature type</div>
        <div class='legend-scale'>
            <ul class='legend-labels'>
                <li><span style='background:#d7ded1'></span>Wild countryside</li>
                <li><span style='background:#f2e6c7'></span>Countryside agriculture</li>
                <li><span style='background:#c2d0d9'></span>Urban buffer</li>
                <li><span style='background:#d7a59f'></span>Open sprawl</li>
                <li><span style='background:#f0d17d'></span>Disconnected suburbia</li>
                <li><span style='background:#8fa37e'></span>Accessible suburbia</li>
                <li><span style='background:#c3abaf'></span>Warehouse/Park land</li>
                <li><span style='background:#e4cbc8'></span>Gridded residential quarters</li>
                <li><span style='background:#94666e'></span>Connected residential neighbourhoods</li>
                <li><span style='background:#678ea6'></span>Dense residential neighbourhoods</li>
                <li><span style='background:#efc758'></span>Dense urban neighbourhoods</li>
                <li><span style='background:#3b6e8c'></span>Local urbanity</li>
                <li><span style='background:#ab888e'></span>Regional urbanity</li>
                <li><span style='background:#bc5b4f'></span>Metropolitan urbanity</li>
                <li><span style='background:#333432'></span>Concentrated urbanity</li>
                <li><span style='background:#a7b799'></span>Hyper concentrated urbanity</li>
            </ul>
        </div>
    </div>

</body>

</html>